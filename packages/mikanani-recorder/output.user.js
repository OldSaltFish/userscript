// ==UserScript==
// @name         蜜柑记录
// @namespace    http://dreamsoul.cn/
// @version      1.0.0
// @description  记录观影进度
// @author       魂祈梦
// @match        https://mikanani.me/*
// @match        https://mikanani.tv/*
// @match        https://mikanani.kas.pub/*
// @grant        GM_registerMenuCommand
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_addStyle
// @run-at       document-idle
// @noframes
// ==/UserScript==


(function() {
  'use strict';
  // 添加全局样式
  GM_addStyle(String.raw`@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after{--un-bg-opacity:100%;--un-text-opacity:100%;--un-translate-x:initial;--un-translate-y:initial;--un-translate-z:initial}::backdrop{--un-bg-opacity:100%;--un-text-opacity:100%;--un-translate-x:initial;--un-translate-y:initial;--un-translate-z:initial}}@property --un-text-opacity{syntax:"<percentage>";inherits:false;initial-value:100%}@property --un-bg-opacity{syntax:"<percentage>";inherits:false;initial-value:100%}@property --un-inset-ring-color{syntax:"*";inherits:false}@property --un-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --un-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --un-inset-shadow-color{syntax:"*";inherits:false}@property --un-ring-color{syntax:"*";inherits:false}@property --un-ring-inset{syntax:"*";inherits:false}@property --un-ring-offset-color{syntax:"*";inherits:false}@property --un-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --un-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --un-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --un-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --un-shadow-color{syntax:"*";inherits:false}@property --un-translate-x{syntax:"*";inherits:false;initial-value:0}@property --un-translate-y{syntax:"*";inherits:false;initial-value:0}@property --un-translate-z{syntax:"*";inherits:false;initial-value:0}:root,:host{--font-sans:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--default-font-family:var(--font-sans);--default-monoFont-family:var(--font-mono);--spacing:.25rem;--colors-white:#fff;--radius-DEFAULT:.25rem;--colors-black:#000;--radius-lg:.5rem;--fontWeight-bold:700;--colors-blue-500:#3080ff;--colors-gray-200:#e5e7eb;--colors-gray-500:#6a7282;--colors-green-500:#00c758;--text-sm-fontSize:.875rem;--text-sm-lineHeight:1.25rem;--text-lg-fontSize:1.125rem;--text-lg-lineHeight:1.75rem;--colors-gray-100:#f3f4f6;--colors-gray-700:#364153;--colors-blue-600:#155dfc;--colors-green-600:#00a544;--radius-md:.375rem;--default-transition-timingFunction:cubic-bezier(.4,0,.2,1);--default-transition-duration:.15s;--colors-gray-900:#101828;--text-xl-fontSize:1.25rem;--text-xl-lineHeight:1.75rem}@supports (color:color(display-p3 0 0 0)){:root,:host{--colors-blue-500:color(display-p3 .266422 .491219 .988624);--colors-gray-200:color(display-p3 .899787 .906171 .92106);--colors-gray-500:color(display-p3 .421287 .446085 .504784);--colors-green-500:color(display-p3 .308734 .774754 .374307);--colors-gray-100:color(display-p3 .953567 .956796 .964321);--colors-gray-700:color(display-p3 .219968 .253721 .318679);--colors-blue-600:color(display-p3 .174493 .358974 .950247);--colors-green-600:color(display-p3 .243882 .640824 .294808);--colors-gray-900:color(display-p3 .070423 .0928982 .151928)}}@supports (color:lab(0% 0 0)){:root,:host{--colors-blue-500:lab(54.1736% 13.3368 -74.6839);--colors-gray-200:lab(91.6229% -.159085 -2.26791);--colors-gray-500:lab(47.7841% -.393212 -10.0268);--colors-green-500:lab(70.5521% -66.5147 45.8072);--colors-gray-100:lab(96.1596% -.082314 -1.13575);--colors-gray-700:lab(27.1134% -.956401 -12.3224);--colors-blue-600:lab(44.0605% 29.0279 -86.0352);--colors-green-600:lab(59.0978% -58.6621 41.2579);--colors-gray-900:lab(8.11897% .811279 -12.254)}}*,:after,:before{box-sizing:border-box;border:0 solid;margin:0;padding:0}::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::-webkit-file-upload-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-featureSettings,normal);font-variation-settings:var(--default-font-variationSettings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-monoFont-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-monoFont-featureSettings,normal);font-variation-settings:var(--default-monoFont-variationSettings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::-webkit-file-upload-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:-webkit-any([multiple],[size])) optgroup{font-weight:bolder}:where(select:-moz-any([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:-webkit-any([multiple],[size])) optgroup option{padding-inline-start:20px}:where(select:-moz-any([multiple],[size])) optgroup option{padding-inline-start:20px}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::-webkit-file-upload-button{margin-inline-end:4px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-year-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-month-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-day-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-hour-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-minute-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-second-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-millisecond-field{padding-block-start:0;padding-block-end:0}::-webkit-datetime-edit-meridiem-field{padding-block-start:0;padding-block-end:0}::-webkit-calendar-picker-indicator{line-height:1}:-moz-ui-invalid{box-shadow:none}button{-webkit-appearance:button;-moz-appearance:button;appearance:button}input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-file-upload-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}.text-lg{font-size:var(--text-lg-fontSize);line-height:var(--un-leading,var(--text-lg-lineHeight))}.text-sm{font-size:var(--text-sm-fontSize);line-height:var(--un-leading,var(--text-sm-lineHeight))}.text-xl{font-size:var(--text-xl-fontSize);line-height:var(--un-leading,var(--text-xl-lineHeight))}.text-\[\#3bc0c3\]{color:color-mix(in oklab,#3bc0c3 var(--un-text-opacity),transparent)}.text-gray-500{color:color-mix(in srgb,var(--colors-gray-500)var(--un-text-opacity),transparent)}.text-white{color:color-mix(in srgb,var(--colors-white)var(--un-text-opacity),transparent)}.hover\:text-gray-700:hover{color:color-mix(in srgb,var(--colors-gray-700)var(--un-text-opacity),transparent)}.font-bold{--un-font-weight:var(--fontWeight-bold);font-weight:var(--fontWeight-bold)}.m-0{margin:calc(var(--spacing)*0)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.ml-2{margin-left:calc(var(--spacing)*2)}.ml-8px{margin-left:8px}.mt-4{margin-top:calc(var(--spacing)*4)}.mt-8px{margin-top:8px}.p-2{padding:calc(var(--spacing)*2)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-4{padding-inline:calc(var(--spacing)*4)}.py-1{padding-block:calc(var(--spacing)*1)}.py-2{padding-block:calc(var(--spacing)*2)}.text-center{text-align:center}.border{border-width:1px}.rounded{border-radius:var(--radius-DEFAULT)}.rounded-full{border-radius:3.40282e38px}.rounded-lg{border-radius:var(--radius-lg)}.rounded-md{border-radius:var(--radius-md)}.bg-black\/50{background-color:color-mix(in srgb,var(--colors-black)50%,transparent)}.bg-blue-500{background-color:color-mix(in srgb,var(--colors-blue-500)var(--un-bg-opacity),transparent)}.bg-gray-200{background-color:color-mix(in srgb,var(--colors-gray-200)var(--un-bg-opacity),transparent)}.bg-gray-900{background-color:color-mix(in srgb,var(--colors-gray-900)var(--un-bg-opacity),transparent)}.bg-green-500{background-color:color-mix(in srgb,var(--colors-green-500)var(--un-bg-opacity),transparent)}.bg-white{background-color:color-mix(in srgb,var(--colors-white)var(--un-bg-opacity),transparent)}.bg-white\/40{background-color:color-mix(in srgb,var(--colors-white)40%,transparent)}.hover\:bg-blue-600:hover{background-color:color-mix(in srgb,var(--colors-blue-600)var(--un-bg-opacity),transparent)}.hover\:bg-gray-100:hover{background-color:color-mix(in srgb,var(--colors-gray-100)var(--un-bg-opacity),transparent)}.hover\:bg-green-600:hover{background-color:color-mix(in srgb,var(--colors-green-600)var(--un-bg-opacity),transparent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.flex{display:flex}.flex-col{flex-direction:column}.gap-2{gap:calc(var(--spacing)*2)}.gap-4{gap:calc(var(--spacing)*4)}.grid{display:grid}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.h-10{height:calc(var(--spacing)*10)}.h-12{height:calc(var(--spacing)*12)}.h-8{height:calc(var(--spacing)*8)}.w-10{width:calc(var(--spacing)*10)}.w-12{width:calc(var(--spacing)*12)}.w-20{width:calc(var(--spacing)*20)}.w-64{width:calc(var(--spacing)*64)}.w-8{width:calc(var(--spacing)*8)}.w-80{width:calc(var(--spacing)*80)}.w-full{width:100%}.inline{display:inline}.hidden{display:none}.cursor-pointer{cursor:pointer}.pointer-events-none{pointer-events:none}.truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.shadow-lg{--un-shadow:0 10px 15px -3px var(--un-shadow-color,#0000001a),0 4px 6px -4px var(--un-shadow-color,#0000001a);box-shadow:var(--un-inset-shadow),var(--un-inset-ring-shadow),var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.-translate-x-1\/2{--un-translate-x:-50%;translate:var(--un-translate-x)var(--un-translate-y)}.-translate-y-1\/2{--un-translate-y:-50%;translate:var(--un-translate-x)var(--un-translate-y)}.transform{transform:var(--un-rotate-x)var(--un-rotate-y)var(--un-rotate-z)var(--un-skew-x)var(--un-skew-y)}.transition-all{transition-property:all;transition-timing-function:var(--un-ease,var(--default-transition-timingFunction));transition-duration:var(--un-duration,var(--default-transition-duration))}.transition-opacity{transition-property:opacity;transition-timing-function:var(--un-ease,var(--default-transition-timingFunction));transition-duration:var(--un-duration,var(--default-transition-duration))}.duration-300{--un-duration:.3s;transition-duration:.3s}.items-center{align-items:center}.inset-0{inset:calc(var(--spacing)*0)}.bottom-24{bottom:calc(var(--spacing)*24)}.left-0{left:calc(var(--spacing)*0)}.left-50vw{left:50vw}.right-2{right:calc(var(--spacing)*2)}.right-4{right:calc(var(--spacing)*4)}.top-0{top:calc(var(--spacing)*0)}.top-2{top:calc(var(--spacing)*2)}.top-45vh{top:45vh}.top-50vh{top:50vh}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}@supports (color:color-mix(in lab, red, red)){.text-gray-500{color:color-mix(in oklab,var(--colors-gray-500)var(--un-text-opacity),transparent)}.text-white{color:color-mix(in oklab,var(--colors-white)var(--un-text-opacity),transparent)}.hover\:text-gray-700:hover{color:color-mix(in oklab,var(--colors-gray-700)var(--un-text-opacity),transparent)}.bg-black\/50{background-color:color-mix(in oklab,var(--colors-black)50%,transparent)}.bg-blue-500{background-color:color-mix(in oklab,var(--colors-blue-500)var(--un-bg-opacity),transparent)}.bg-gray-200{background-color:color-mix(in oklab,var(--colors-gray-200)var(--un-bg-opacity),transparent)}.bg-gray-900{background-color:color-mix(in oklab,var(--colors-gray-900)var(--un-bg-opacity),transparent)}.bg-green-500{background-color:color-mix(in oklab,var(--colors-green-500)var(--un-bg-opacity),transparent)}.bg-white{background-color:color-mix(in oklab,var(--colors-white)var(--un-bg-opacity),transparent)}.bg-white\/40{background-color:color-mix(in oklab,var(--colors-white)40%,transparent)}.hover\:bg-blue-600:hover{background-color:color-mix(in oklab,var(--colors-blue-600)var(--un-bg-opacity),transparent)}.hover\:bg-gray-100:hover{background-color:color-mix(in oklab,var(--colors-gray-100)var(--un-bg-opacity),transparent)}.hover\:bg-green-600:hover{background-color:color-mix(in oklab,var(--colors-green-600)var(--un-bg-opacity),transparent)}}@media (min-width:40rem){.sm\:flex{display:flex}.sm\:absolute{position:absolute}}
`);
  "use strict";(self.webpackChunkmikanani_recorder=self.webpackChunkmikanani_recorder||[]).push([["568"],{676:function(){},266:function(e,t,n){let r;n.d(t,{F3:()=>w,GW:()=>y,H3:()=>A,LM:()=>F,Py:()=>S,U2:()=>L,Zw:()=>m,gQ:()=>b,so:()=>v,vH:()=>l});let l={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return o(this.context.count)},getNextContextId(){return o(this.context.count++)}};function o(e){let t=String(e),n=t.length-1;return l.context.id+(n?String.fromCharCode(96+n):"")+t}Symbol("solid-proxy");let s=Symbol("solid-track");Symbol("solid-dev-component");let u={equals:(e,t)=>e===t},i=E,f={owned:null,cleanups:null,context:null,owner:null};var a=null;let c=null,d=null,h=null,p=null,g=0;function v(e,t){let n=d,r=a,l=0===e.length,o=void 0===t?r:t,s=l?f:{owned:null,cleanups:null,context:o?o.context:null,owner:o},u=l?e:()=>e(()=>m(()=>_(s)));a=s,d=null;try{return H(u,!0)}finally{d=n,a=r}}function b(e,t){let n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},u,t):u).equals||void 0};return[C.bind(n),e=>("function"==typeof e&&(e=e(c&&c.running&&c.sources.has(n)?n.tValue:n.value)),k(n,e))]}function w(e,t,n){O($(e,t,!1,1))}function y(e,t,n){var l;let o;i=V;let s=$(e,t,!1,1),u=r&&(l=r,a&&a.context&&void 0!==(o=a.context[l.id])?o:l.defaultValue);u&&(s.suspense=u),n&&n.render||(s.user=!0),p?p.push(s):O(s)}function S(e,t,n){n=n?Object.assign({},u,n):u;let r=$(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,O(r),C.bind(r)}function m(e){if(null===d)return e();let t=d;d=null;try{return e()}finally{d=t}}function A(e){y(()=>m(e))}let[,x]=b(!1);function C(){let e=c&&c.running;if(this.sources&&(e?this.tState:this.state))if((e?this.tState:this.state)===1)O(this);else{let e=h;h=null,H(()=>M(this),!1),h=e}if(d){let e=this.observers?this.observers.length:0;d.sources?(d.sources.push(this),d.sourceSlots.push(e)):(d.sources=[this],d.sourceSlots=[e]),this.observers?(this.observers.push(d),this.observerSlots.push(d.sources.length-1)):(this.observers=[d],this.observerSlots=[d.sources.length-1])}return e&&c.sources.has(this)?this.tValue:this.value}function k(e,t,n){let r=c&&c.running&&c.sources.has(e)?e.tValue:e.value;if(!e.comparator||!e.comparator(r,t)){if(c){let r=c.running;(r||!n&&c.sources.has(e))&&(c.sources.add(e),e.tValue=t),r||(e.value=t)}else e.value=t;e.observers&&e.observers.length&&H(()=>{for(let t=0;t<e.observers.length;t+=1){let n=e.observers[t],r=c&&c.running;r&&c.disposed.has(n)||((r?n.tState:n.state)||(n.pure?h.push(n):p.push(n),n.observers&&function e(t){let n=c&&c.running;for(let r=0;r<t.observers.length;r+=1){let l=t.observers[r];(n?l.tState:l.state)||(n?l.tState=2:l.state=2,l.pure?h.push(l):p.push(l),l.observers&&e(l))}}(n)),r?n.tState=1:n.state=1)}if(h.length>1e6)throw h=[],Error()},!1)}return t}function O(e){if(!e.fn)return;_(e);let t=g;N(e,c&&c.running&&c.sources.has(e)?e.tValue:e.value,t),c&&!c.running&&c.sources.has(e)&&queueMicrotask(()=>{H(()=>{c&&(c.running=!0),d=a=e,N(e,e.tValue,t),d=a=null},!1)})}function N(e,t,n){let r,l=a,o=d;d=a=e;try{r=e.fn(t)}catch(t){return e.pure&&(c&&c.running?(e.tState=1,e.tOwned&&e.tOwned.forEach(_),e.tOwned=void 0):(e.state=1,e.owned&&e.owned.forEach(_),e.owned=null)),e.updatedAt=n+1,B(t)}finally{d=o,a=l}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?k(e,r,!0):c&&c.running&&e.pure?(c.sources.add(e),e.tValue=r):e.value=r,e.updatedAt=n)}function $(e,t,n,r=1,l){let o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:a,context:a?a.context:null,pure:n};return c&&c.running&&(o.state=0,o.tState=r),null===a||a!==f&&(c&&c.running&&a.pure?a.tOwned?a.tOwned.push(o):a.tOwned=[o]:a.owned?a.owned.push(o):a.owned=[o]),o}function T(e){let t=c&&c.running;if((t?e.tState:e.state)===0)return;if((t?e.tState:e.state)===2)return M(e);if(e.suspense&&m(e.suspense.inFallback))return e.suspense.effects.push(e);let n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<g);){if(t&&c.disposed.has(e))return;(t?e.tState:e.state)&&n.push(e)}for(let r=n.length-1;r>=0;r--){if(e=n[r],t){let t=e,l=n[r+1];for(;(t=t.owner)&&t!==l;)if(c.disposed.has(t))return}if((t?e.tState:e.state)===1)O(e);else if((t?e.tState:e.state)===2){let t=h;h=null,H(()=>M(e,n[0]),!1),h=t}}}function H(e,t){if(h)return e();let n=!1;t||(h=[]),p?n=!0:p=[],g++;try{let t=e();return function(e){let t;if(h&&(E(h),h=null),e)return;if(c)if(c.promises.size||c.queue.size){if(c.running){c.running=!1,c.effects.push.apply(c.effects,p),p=null,x(!0);return}}else{let e=c.sources,n=c.disposed;for(let e of(p.push.apply(p,c.effects),t=c.resolve,p))"tState"in e&&(e.state=e.tState),delete e.tState;c=null,H(()=>{for(let e of n)_(e);for(let t of e){if(t.value=t.tValue,t.owned)for(let e=0,n=t.owned.length;e<n;e++)_(t.owned[e]);t.tOwned&&(t.owned=t.tOwned),delete t.tValue,delete t.tOwned,t.tState=0}x(!1)},!1)}let n=p;p=null,n.length&&H(()=>i(n),!1),t&&t()}(n),t}catch(e){n||(p=null),h=null,B(e)}}function E(e){for(let t=0;t<e.length;t++)T(e[t])}function V(e){let t,n=0;for(t=0;t<e.length;t++){let r=e[t];r.user?e[n++]=r:T(r)}if(l.context){if(l.count){l.effects||(l.effects=[]),l.effects.push(...e.slice(0,n));return}l.context=void 0}for(l.effects&&(l.done||!l.count)&&(e=[...l.effects,...e],n+=l.effects.length,delete l.effects),t=0;t<n;t++)T(e[t])}function M(e,t){let n=c&&c.running;n?e.tState=0:e.state=0;for(let r=0;r<e.sources.length;r+=1){let l=e.sources[r];if(l.sources){let e=n?l.tState:l.state;1===e?l!==t&&(!l.updatedAt||l.updatedAt<g)&&T(l):2===e&&M(l,t)}}}function _(e){let t;if(e.sources)for(;e.sources.length;){let t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){let e=r.pop(),l=t.observerSlots.pop();n<r.length&&(e.sourceSlots[l]=n,r[n]=e,t.observerSlots[n]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)_(e.tOwned[t]);delete e.tOwned}if(c&&c.running&&e.pure)!function e(t,n){if(n||(t.tState=0,c.disposed.add(t)),t.owned)for(let n=0;n<t.owned.length;n++)e(t.owned[n])}(e,!0);else if(e.owned){for(t=e.owned.length-1;t>=0;t--)_(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}c&&c.running?e.tState=0:e.state=0}function j(e,t,n){try{for(let n of t)n(e)}catch(e){B(e,n&&n.owner||null)}}function B(e,t=a){let n=e instanceof Error?e:Error("string"==typeof e?e:"Unknown error",{cause:e});!0;throw n}let P=Symbol("fallback");function q(e){for(let t=0;t<e.length;t++)e[t]()}function F(e,t){return m(()=>e(t||{}))}function L(e){let t="fallback"in e&&{fallback:()=>e.fallback};return S(function(e,t,n={}){var r;let l=[],o=[],u=[],i=0,f=t.length>1?[]:null;return r=()=>q(u),null===a||(null===a.cleanups?a.cleanups=[r]:a.cleanups.push(r)),()=>{let r=e()||[],a=r.length,c,d;return r[s],m(()=>{let e,t,s,p,g,b,w,y,S;if(0===a)0!==i&&(q(u),u=[],l=[],o=[],i=0,f&&(f=[])),n.fallback&&(l=[P],o[0]=v(e=>(u[0]=e,n.fallback())),i=1);else if(0===i){for(d=0,o=Array(a);d<a;d++)l[d]=r[d],o[d]=v(h);i=a}else{for(s=Array(a),p=Array(a),f&&(g=Array(a)),b=0,w=Math.min(i,a);b<w&&l[b]===r[b];b++);for(w=i-1,y=a-1;w>=b&&y>=b&&l[w]===r[y];w--,y--)s[y]=o[w],p[y]=u[w],f&&(g[y]=f[w]);for(e=new Map,t=Array(y+1),d=y;d>=b;d--)S=r[d],c=e.get(S),t[d]=void 0===c?-1:c,e.set(S,d);for(c=b;c<=w;c++)S=l[c],void 0!==(d=e.get(S))&&-1!==d?(s[d]=o[c],p[d]=u[c],f&&(g[d]=f[c]),d=t[d],e.set(S,d)):u[c]();for(d=b;d<a;d++)d in s?(o[d]=s[d],u[d]=p[d],f&&(f[d]=g[d],f[d](d))):o[d]=v(h);o=o.slice(0,i=a),l=r.slice(0)}return o});function h(e){if(u[d]=e,f){let[e,n]=b(d);return f[d]=n,t(r[d],e)}return t(r[d])}}}(()=>e.each,e.children,t||void 0))}},206:function(e,t,n){n.d(t,{$T:()=>d,D$:()=>c,P$:()=>f,Qj:()=>i,X$:()=>l,XK:()=>u,ok:()=>a,sY:()=>s});var r=n(266);Object.create(null),Object.create(null);let l=e=>(0,r.Py)(()=>e()),o="_$DX_DELEGATE";function s(e,t,n,l={}){let o;return(0,r.so)(r=>{o=r,t===document?e():d(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{o(),t.textContent=""}}function u(e,t,n,l){let o,s=()=>{let t=l?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return t.innerHTML=e,n?t.content.firstChild.firstChild:l?t.firstChild:t.content.firstChild},u=t?()=>(0,r.Zw)(()=>document.importNode(o||(o=s()),!0)):()=>(o||(o=s())).cloneNode(!0);return u.cloneNode=u,u}function i(e,t=window.document){let n=t[o]||(t[o]=new Set);for(let r=0,l=e.length;r<l;r++){let l=e[r];n.has(l)||(n.add(l),t.addEventListener(l,p))}}function f(e,t,n){h(e)||(null==n?e.removeAttribute(t):e.setAttribute(t,n))}function a(e,t){h(e)||(null==t?e.removeAttribute("class"):e.className=t)}function c(e,t,n){return(0,r.Zw)(()=>e(t,n))}function d(e,t,n,l){if(void 0===n||l||(l=[]),"function"!=typeof t)return g(e,t,l,n);(0,r.F3)(r=>g(e,t(),r,n),l)}function h(e){return!!r.vH.context&&!r.vH.done&&(!e||e.isConnected)}function p(e){if(r.vH.registry&&r.vH.events&&r.vH.events.find(([t,n])=>n===e))return;let t=e.target,n=`$$${e.type}`,l=e.target,o=e.currentTarget,s=t=>Object.defineProperty(e,"target",{configurable:!0,value:t}),u=()=>{let r=t[n];if(r&&!t.disabled){let l=t[`${n}Data`];if(void 0!==l?r.call(t,l,e):r.call(t,e),e.cancelBubble)return}return t.host&&"string"!=typeof t.host&&!t.host._$host&&t.contains(e.target)&&s(t.host),!0},i=()=>{for(;u()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>t||document}),r.vH.registry&&!r.vH.done&&(r.vH.done=_$HY.done=!0),e.composedPath){let n=e.composedPath();s(n[0]);for(let e=0;e<n.length-2&&(t=n[e],u());e++){if(t._$host){t=t._$host,i();break}if(t.parentNode===o)break}}else i();s(l)}function g(e,t,n,l,o){let s=h(e);if(s){n||(n=[...e.childNodes]);let t=[];for(let e=0;e<n.length;e++){let r=n[e];8===r.nodeType&&"!$"===r.data.slice(0,2)?r.remove():t.push(r)}n=t}for(;"function"==typeof n;)n=n();if(t===n)return n;let u=typeof t,i=void 0!==l;if(e=i&&n[0]&&n[0].parentNode||e,"string"===u||"number"===u){if(s||"number"===u&&(t=t.toString())===n)return n;if(i){let r=n[0];r&&3===r.nodeType?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=b(e,n,l,r)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===u){if(s)return n;n=b(e,n,l)}else if("function"===u)return(0,r.F3)(()=>{let r=t();for(;"function"==typeof r;)r=r();n=g(e,r,n,l)}),()=>n;else if(Array.isArray(t)){let u=[],f=n&&Array.isArray(n);if(function e(t,n,r,l){let o=!1;for(let s=0,u=n.length;s<u;s++){let u=n[s],i=r&&r[t.length],f;if(null==u||!0===u||!1===u);else if("object"==(f=typeof u)&&u.nodeType)t.push(u);else if(Array.isArray(u))o=e(t,u,i)||o;else if("function"===f)if(l){for(;"function"==typeof u;)u=u();o=e(t,Array.isArray(u)?u:[u],Array.isArray(i)?i:[i])||o}else t.push(u),o=!0;else{let e=String(u);i&&3===i.nodeType&&i.data===e?t.push(i):t.push(document.createTextNode(e))}}return o}(u,t,n,o))return(0,r.F3)(()=>n=g(e,u,n,l,!0)),()=>n;if(s){if(!u.length)return n;if(void 0===l)return n=[...e.childNodes];let t=u[0];if(t.parentNode!==e)return n;let r=[t];for(;(t=t.nextSibling)!==l;)r.push(t);return n=r}if(0===u.length){if(n=b(e,n,l),i)return n}else f?0===n.length?v(e,u,l):function(e,t,n){let r=n.length,l=t.length,o=r,s=0,u=0,i=t[l-1].nextSibling,f=null;for(;s<l||u<o;){if(t[s]===n[u]){s++,u++;continue}for(;t[l-1]===n[o-1];)l--,o--;if(l===s){let t=o<r?u?n[u-1].nextSibling:n[o-u]:i;for(;u<o;)e.insertBefore(n[u++],t)}else if(o===u)for(;s<l;)f&&f.has(t[s])||t[s].remove(),s++;else if(t[s]===n[o-1]&&n[u]===t[l-1]){let r=t[--l].nextSibling;e.insertBefore(n[u++],t[s++].nextSibling),e.insertBefore(n[--o],r),t[l]=n[o]}else{if(!f){f=new Map;let e=u;for(;e<o;)f.set(n[e],e++)}let r=f.get(t[s]);if(null!=r)if(u<r&&r<o){let i=s,a=1,c;for(;++i<l&&i<o&&null!=(c=f.get(t[i]))&&c===r+a;)a++;if(a>r-u){let l=t[s];for(;u<r;)e.insertBefore(n[u++],l)}else e.replaceChild(n[u++],t[s++])}else s++;else t[s++].remove()}}}(e,n,u):(n&&b(e),v(e,u));n=u}else if(t.nodeType){if(s&&t.parentNode)return n=i?[t]:t;if(Array.isArray(n)){if(i)return n=b(e,n,l,t);b(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}return n}function v(e,t,n=null){for(let r=0,l=t.length;r<l;r++)e.insertBefore(t[r],n)}function b(e,t,n,r){if(void 0===n)return e.textContent="";let l=r||document.createTextNode("");if(t.length){let r=!1;for(let o=t.length-1;o>=0;o--){let s=t[o];if(l!==s){let t=s.parentNode===e;r||o?t&&s.remove():t?e.replaceChild(l,s):e.insertBefore(l,n)}else r=!0}}else e.insertBefore(l,n);return[l]}Symbol()}}]);
(()=>{"use strict";var e={544:function(e,t,l){var n,r=l(206),i=l(266);l(676);var o=(0,r.XK)("<div>");let a=(0,i.so)(()=>{let[e,t]=(0,i.gQ)(!1),[l,n]=(0,i.gQ)("");return{show:function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;n(e),t(!0),setTimeout(()=>t(!1),l)},component:()=>{var t;return t=o(),(0,r.$T)(t,l),(0,i.F3)(()=>(0,r.ok)(t,`fixed left-50vw top-50vh transform -translate-x-1/2 -translate-y-1/2 px-4 py-2 rounded-md shadow-lg transition-opacity duration-300 flex items-center gap-2 justify-center ${e()?"opacity-100":"opacity-0 pointer-events-none"} bg-gray-900 text-white`)),t}}}),u=(e,t)=>{a.show(e,t)},s="mikanani-data",c=["不想看","不好看","勉强能看","一般","好看","神作"],d=()=>GM_getValue(s)||{bangumis:[],isCollapsed:!1,blockedSubgroups:[],subGroups:[]},g=e=>{let t=e.match(/\/Home\/Bangumi\/(\d+)/);return t?t[1]:null},m=e=>{let t=d(),l=t.bangumis.find(t=>t.id===e.id);l?Object.assign(l,e):t.bangumis.push(e),GM_setValue(s,t)},f=e=>d().bangumis.find(t=>t.id===e)||null;function b(e){return Array.from(e.childNodes).filter(e=>{var t;return e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE&&(null==(t=e.textContent)?void 0:t.trim())!==""})}var p=(0,r.XK)(`<button class=ml-8px>\u{590D}\u{5236}`),v=(0,r.XK)(`<button class=floating-menu-button>\u{5C4F}\u{853D}`),h=(0,r.XK)(`<button class=ml-2>\u{5907}\u{6CE8}\u{FF1A}`),y=(0,r.XK)("<input type=text>"),x=(0,r.XK)(`<button>\u{786E}\u{8BA4}`),w=(0,r.XK)(`<button>\u{53D6}\u{6D88}`),k=(0,r.XK)(`<span title=\u{70B9}\u{51FB}\u{53D6}\u{6D88}\u{5C4F}\u{853D}>\u{1F9FF}`),$=(0,r.XK)('<div><button class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">'),E=(0,r.XK)(`<div class=mt-4><div class="text-center font-bold mb-2 truncate"></div><div class="flex items-center justify-between"><button class="w-8 h-8 bg-gray-200 rounded-full">-</button><input type=number min=0 class="w-20 text-center border rounded"><button class="w-8 h-8 bg-gray-200 rounded-full">+</button></div><button class="mt-4 w-full bg-blue-500 text-white rounded py-2 hover:bg-blue-600">\u{4FDD}\u{5B58}`);let S=e=>{var t,l;let n=b(e)[0],r="",i="";return n.nodeType===Node.TEXT_NODE?r=(null==(t=n.textContent)?void 0:t.trim())??"":n.nodeType==Node.ELEMENT_NODE&&(r=n.innerText,(null==n?void 0:n.href)&&(i=(null==(l=n.href.match(/\/Home\/PublishGroup\/(\d+)/))?void 0:l[1])||"")),{name:r,id:i}},C=()=>{var e,t,l,n;let o=(()=>{let e=location.pathname.match(/\/Home\/Bangumi\/(\d+)/);return e?e[1]:null})();if(!o)return null;let[a,c]=(0,i.gQ)([]),g=document.querySelectorAll(".subgroup-text"),C=[],F=d();c((null==(e=F.subGroups)?void 0:e.filter(e=>e.isBlocked).map(e=>e.name))||[]);let L=e=>{var t;return(t=p()).$$click=()=>{e.text&&navigator.clipboard.writeText(e.text).then(()=>{u("✓ 已复制")}).catch(e=>{console.error("复制失败:",e),u("复制失败")})},t};g.forEach(e=>{var t,l;let n,{id:o,name:a}=S(e);if(!a)return void u("获取字幕组名称失败，脚本逻辑需要更新。");C.push({el:e,name:a,id:o});let g=()=>{var e;return(e=v()).$$click=()=>{var e;let t=d(),l=new Set(C.map(e=>e.id));c(Array.from(new Set([...((null==(e=t.subGroups)?void 0:e.filter(e=>l.has(e.id)&&e.isBlocked))||[]).map(e=>e.name),a])));let n=t.subGroups||[],r=n.findIndex(e=>e.id===o);-1!==r?n[r]={...n[r],isBlocked:!0}:n.push({name:a,id:o,isBlocked:!0,remark:""}),GM_setValue(s,{...t,subGroups:n}),u("✓ 已屏蔽")},e},[m,f]=(0,i.gQ)(!1),[b,p]=(0,i.gQ)((null==(l=F.subGroups)||null==(t=l.find(e=>e.id===o))?void 0:t.remark)||""),k=()=>{let e=d(),t=e.subGroups||[],l=t.findIndex(e=>e.id===o);-1!==l?t[l]={...t[l],remark:b()}:t.push({name:a,id:o,isBlocked:!1,remark:b()}),GM_setValue(s,{...e,subGroups:t}),u("✓ 修改备注成功"),f(!1)},$=()=>{var e,t,l,o,a;return(0,i.GW)(()=>{m()&&n&&n.focus()}),[((e=h()).$$click=()=>{f(!m())},e),((t=y()).$$keydown=e=>{"Enter"===e.key&&k()},t.addEventListener("focus",e=>f(!0)),t.$$input=e=>p(e.currentTarget.value),"function"==typeof(l=n)?(0,r.D$)(l,t):n=t,(0,i.F3)(e=>{var l=`ml-2 text-[#3bc0c3] ${m()?"border":""}`,n=!m();return l!==e.e&&(0,r.ok)(t,e.e=l),n!==e.t&&(t.readOnly=e.t=n),e},{e:void 0,t:void 0}),(0,i.F3)(()=>t.value=b()),t),((o=x()).$$click=k,(0,i.F3)(()=>(0,r.ok)(o,`ml-2 ${m()?"":"hidden"}`)),o),((a=w()).$$click=()=>f(!1),(0,i.F3)(()=>(0,r.ok)(a,`ml-2 floating-menu-button ${m()?"":"hidden"}`)),a)]},E=e.querySelector(".mikan-rss");if(E){let e=E.href,t=document.createElement("span");(0,r.sY)(()=>(0,i.LM)(g,{}),t),(0,r.sY)(()=>(0,i.LM)(L,{text:e}),t),(0,r.sY)(()=>(0,i.LM)($,{}),t),E.after(t)}}),document.querySelectorAll(".leftbar-item").forEach(e=>{var t;e.style.position="relative";let l=null==(t=e.querySelector(".subgroup-name"))?void 0:t.textContent;if(!l)return;let n=()=>{var e;return(e=k()).$$click=()=>{var e,t;let n=d(),r=new Set(C.map(e=>e.id));c(((null==(e=n.subGroups)?void 0:e.filter(e=>r.has(e.id)&&e.isBlocked))||[]).map(e=>e.name).filter(e=>e!==l));let i=n.subGroups||[],o=null==(t=n.subGroups)?void 0:t.find(e=>e.name===l);if(!o)return void u("数据异常，无法移除屏蔽");o.isBlocked=!1,GM_setValue(s,{...n,subGroups:i}),u("✓ 已移除屏蔽")},(0,i.F3)(()=>(0,r.ok)(e,`absolute left-0 text-xl mt-8px cursor-pointer ${a().includes(l)?"inline":"hidden"}`)),e};(0,r.sY)(()=>(0,i.LM)(n,{}),e)});let B=document.querySelector(".bangumi-title");(0,r.sY)(()=>(0,i.LM)(L,{get text(){var e;return(null==(e=b(B)[0].textContent)?void 0:e.trim())||""}}),B),(0,i.GW)(()=>{g.forEach(e=>{let{name:t}=S(e);if(t){let l=e.closest(".subgroup-text"),n=l.nextElementSibling,r=a().includes(t)?"none":"";l.style.display=r,n.style.display=r,n.nextElementSibling&&n.nextElementSibling.classList.contains("episode-expand")&&(n.nextElementSibling.style.display=r)}})});let[M,O]=(0,i.gQ)(0),[T,A]=(0,i.gQ)(!1),[G,j]=(0,i.gQ)("");(0,i.H3)(()=>{let e=d(),t=f(o);t?(O(t.episodeCount),j(t.title)):j((()=>{let e=document.title.match(/Mikan Project - (.+)/);return e?e[1]:""})()),A(e.isCollapsed)});let X=()=>{m({id:o,title:G(),episodeCount:M(),rating:0})};return(l=(t=$()).firstChild).$$click=()=>{let e=!T();A(e);let t=d();t.isCollapsed=e,GM_setValue(s,t)},(0,r.$T)(l,()=>T()?"展开":"收起"),(0,r.$T)(t,(n=(0,r.X$)(()=>!T()),()=>{var e,t,l,o,a,u,s;return n()&&(u=(a=(o=(l=(t=(e=E()).firstChild).nextSibling).firstChild).nextSibling).nextSibling,s=l.nextSibling,(0,r.$T)(t,G),o.$$click=()=>O(e=>Math.max(0,e-1)),a.$$input=e=>O(parseInt(e.currentTarget.value)||0),u.$$click=()=>O(e=>e+1),s.$$click=X,(0,i.F3)(()=>(0,r.P$)(t,"title",G())),(0,i.F3)(()=>a.value=M()),e)}),null),(0,i.F3)(()=>(0,r.ok)(t,`fixed top-45vh right-4 bg-white shadow-lg rounded-lg p-4 transition-all duration-300 ${T()?"w-12 h-12":"w-64"}`)),t};(0,r.Qj)(["click","input","keydown"]);var F=(0,r.XK)('<div class="sm:absolute sm:flex top-0 left-0 w-full bg-white/40 p-2 grid grid-cols-3 gap-2 text-sm">'),L=(0,r.XK)("<button>"),B=(0,r.XK)(`<button class="fixed right-4 bottom-24 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-100">\u{2699}\u{FE0F}`),M=(0,r.XK)(`<div class="fixed inset-0 bg-black/50 flex items-center justify-center"><div class="bg-white rounded-lg p-6 w-80"><div class="flex justify-between items-center mb-4"><h3 class="m-0 text-lg font-bold">\u{8BBE}\u{7F6E}</h3><button class="text-gray-500 hover:text-gray-700">\u{2715}</button></div><div class="flex flex-col gap-4"><button class="w-full bg-blue-500 text-white rounded py-2 hover:bg-blue-600">\u{5BFC}\u{51FA}\u{756A}\u{5267}\u{4FE1}\u{606F}</button><div><label>\u{663E}\u{793A}\u{4F4E}\u{8BC4}\u{5206}\u{756A}\u{5267}(0-1\u{5206})<input style=margin:0;vertical-align:middle; type=checkbox></label><label>\u{5BFC}\u{51FA}\u{4F4E}\u{8BC4}\u{5206}\u{756A}\u{5267}(0-1\u{5206})<input style=margin:0;vertical-align:middle; type=checkbox></label></div><button class="w-full bg-green-500 text-white rounded py-2 hover:bg-green-600">\u{5BFC}\u{51FA}\u{914D}\u{7F6E}\u{6587}\u{4EF6}`),O=(0,r.XK)("<div class=ds-script>");let T=null==(n=d())?void 0:n.config,A=e=>{var t;let[l,n]=(0,i.gQ)(999);(0,i.H3)(async()=>{let t=g(e.anElement.href);if(!t)return;let l=await f(t);l&&void 0!==l.rating&&n(l.rating)}),(0,i.GW)(()=>{if(1>=l()&&!(null==T?void 0:T.isShowLowRating)){let t=e.anElement.closest("li");if(t){t.style.display="none";let e=t.parentElement;if(e&&Array.from(e.children).every(e=>"none"===e.style.display)){let t=e.closest(".an-box");t&&(t.style.display="none")}}}});let o=async t=>{let l=g(e.anElement.href);l&&(n(t),await m({id:l,title:e.anElement.getAttribute("title")||"",rating:t,episodeCount:0}))};return t=F(),(0,r.$T)(t,(0,i.LM)(i.U2,{each:c,children:(e,t)=>{var n;return(n=L()).$$click=()=>o(t()),(0,r.P$)(n,"title",e),(0,r.$T)(n,t),(0,i.F3)(()=>(0,r.ok)(n,`px-2 py-1 rounded ${l()===t()?"bg-blue-500 text-white":"bg-gray-200"}`)),n}})),t},G=()=>{var e;if("/"!==location.pathname)return null;let[t,l]=(0,i.gQ)(!1),n=async e=>{let t=await fetch(e),l=await t.blob();return await new Promise((e,t)=>{let n=new FileReader;n.onloadend=()=>e(n.result),n.onerror=t,n.readAsDataURL(l)})},o=()=>{let e=new Blob([JSON.stringify(GM_getValue(s),null,2)],{type:"application/json"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="mikanani-config.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)};return[((e=B()).$$click=()=>l(!0),e),(0,r.X$)(()=>{var e,a,c,m,f,b,p,v,h;return(0,r.X$)(()=>!!t())()&&(c=(a=(e=M()).firstChild.firstChild).firstChild.nextSibling,p=(b=(f=(m=a.nextSibling.firstChild).nextSibling).firstChild).firstChild.nextSibling,v=b.nextSibling.firstChild.nextSibling,h=f.nextSibling,c.$$click=()=>l(!1),m.$$click=async()=>{u("需要较长时间，请稍等，完成后会提示下载。");let e=d(),t=[];window.innerWidth<=990?(()=>{for(let r of Array.from(document.querySelectorAll("div.m-week-square a"))){var l,n;let i,o=g(r.href);if(!o)continue;let a=null==(l=e.bangumis.find(e=>e.id===o))?void 0:l.rating;if(!(null==(n=e.config)?void 0:n.isExportLowRating)&&void 0!==a&&a<=1)continue;let u=r.querySelector("img");if(!u||!(i=u.src?u.src:u.dataset.src?location.origin+u.dataset.src:null))continue;let s=new URL(i),c=s.searchParams.get("format");s.search="",c&&s.searchParams.set("format",c),t.push({id:o,title:r.title||"",coverUrl:s.toString(),rating:a||0})}})():(()=>{for(let i of Array.from(document.querySelectorAll(".list-inline li"))){var l,n,r;let o=i.querySelector(".an-text");if(!o)continue;let a=g(o.href),u=null==(l=e.bangumis.find(e=>e.id===a))?void 0:l.rating;if(!(null==(n=e.config)?void 0:n.isExportLowRating)&&void 0!==u&&u<=1)continue;let s=null,c=null,d=i.querySelector("span");if(!d||!(s=(null==(r=getComputedStyle(d).backgroundImage.match(/url\(["']?(.*?)["']?\)/))?void 0:r[1])||null)&&!(s=d.dataset.src?location.origin+d.dataset.src:null))continue;let m=new URL(s),f=m.searchParams.get("format");m.search="",f&&m.searchParams.set("format",f),c=o.title,a&&t.push({id:a,title:c||"",coverUrl:m.toString(),rating:u||0})}})();let l=t.reduce((e,t,l)=>{let n=Math.floor(l/10);return e[n]||(e[n]=[]),e[n].push(t),e},[]);for(let e=0;e<l.length;e++){let t=l[e];console.log(`\u{6B63}\u{5728}\u{5904}\u{7406}\u{7B2C}${e+1}\u{7EC4}\u{FF0C}\u{5171}${l.length}\u{7EC4}`);let r=t.map(async e=>{let t;try{t=await n(e.coverUrl),e.coverBase64=t}catch(e){console.error("获取图片失败:",e);return}});await Promise.all(r)}let r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download="mikanani-bangumis.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),u("所有封面收集任务已完成")},p.addEventListener("change",e=>{let t=d();t.config={...t.config,isShowLowRating:e.target.checked},GM_setValue(s,t),e.target.checked&&location.reload()}),v.addEventListener("change",e=>{let t=d();t.config={...t.config,isExportLowRating:e.target.checked},GM_setValue(s,t)}),h.$$click=o,(0,i.F3)(()=>{var e;return p.checked=(null==(e=d().config)?void 0:e.isShowLowRating)||!1}),(0,i.F3)(()=>{var e;return v.checked=(null==(e=d().config)?void 0:e.isExportLowRating)||!1}),e)})]},j=()=>{document.querySelectorAll(".an-text").forEach(e=>{let t=e.closest("li");t&&(t.style.position="relative",(0,r.sY)(()=>(0,i.LM)(A,{anElement:e}),t))}),document.querySelectorAll(".m-week-square a").forEach(e=>{let t=e.closest(".m-week-square"),l=window.getComputedStyle(t).marginBottom;if(l){let e=parseFloat(l);t.style.marginBottom=e+80+"px"}else t.style.marginBottom="80px";let n=e.closest("div");n&&(0,r.sY)(()=>(0,i.LM)(A,{anElement:e}),n)})},X=()=>{var e;return(0,i.H3)(()=>{if("/"===location.pathname){j();let e=new MutationObserver(e=>{let t=e[0];t.addedNodes.length>1&&t.removedNodes.length>1&&j()}),t=document.querySelector("#sk-body");t&&e.observe(t,{childList:!0})}}),e=O(),(0,r.$T)(e,(0,i.LM)(C,{}),null),(0,r.$T)(e,(0,i.LM)(G,{}),null),(0,r.$T)(e,()=>a.component(),null),e};(0,r.sY)(()=>(0,i.LM)(X,{}),document.body),(0,r.Qj)(["click"])}},t={};function l(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,l),i.exports}l.m=e,l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=[];l.O=(t,n,r,i)=>{if(n){i=i||0;for(var o=e.length;o>0&&e[o-1][2]>i;o--)e[o]=e[o-1];e[o]=[n,r,i];return}for(var a=1/0,o=0;o<e.length;o++){for(var[n,r,i]=e[o],u=!0,s=0;s<n.length;s++)(!1&i||a>=i)&&Object.keys(l.O).every(e=>l.O[e](n[s]))?n.splice(s--,1):(u=!1,i<a&&(a=i));if(u){e.splice(o--,1);var c=r();void 0!==c&&(t=c)}}return t}})(),(()=>{var e={980:0};l.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[o,a,u]=n,s=0;if(o.some(t=>0!==e[t])){for(r in a)l.o(a,r)&&(l.m[r]=a[r]);if(u)var c=u(l)}for(t&&t(n);s<o.length;s++)i=o[s],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(c)},n=self.webpackChunkmikanani_recorder=self.webpackChunkmikanani_recorder||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=l.O(void 0,["568"],function(){return l(544)});n=l.O(n)})();

})();
